---
name: useScrollDirection
menu: Hooks
route: /use-scroll-direction
---

import {Playground, Props} from 'docz';
import {useScrollDirection, ScrollDirection} from './src';
import {animated, config, useSpring} from 'react-spring';
import useSize from '@hzcore/hook-size';

# useScrollDirection

A React [hook] for components that care about
the nearest scrollable container's scroll direction.

## Installation

```shell
yarn add @hzcore/scroll-monitor
```

## Usage

```
import {useScrollDirection} from '@hzcore/scroll-monitor';
```

### Signature

```ts
function useScrollDirection(): [ScrollDirection, React.RefObject<HTMLElement>];
```

or, with a `providedRef`:

```ts
function useScrollDirection(
  providedRef: React.RefObject<HTMLElement>,
): ScrollDirection;
```

### providedRef: `providedRef?: React.RefObject<HTMLElement>`

An optional ref object to use.
Useful when the component needs to handle ref forwarding.

See [Usage with Shared Ref / Ref Forwarding] for more.

### returns `ScrollDirection | [ScrollDirection, React.RefObject<HTMLElement>]`

If a `providedRef` is passed to `useScrollDirection`,
returns a `ScrollDirection` value.

If no `providedRef` is passed, returns an array containing a
`ScrollDirection` object and a `ref` object. The `ref` should be passed
to an underlying DOM node. Note that the node does not have to be scrollable itself,
as `useScrollDirection` will traverse the DOM to find a scrollable parent
to observe.

The `ScrollDirection` object shape is:

```ts
interface ScrollDirection {
  /**
   * The direction the nearest scrollable container
   * most recently scrolled vertically,
   * where 'direction' is either 'up' or 'down'.
   */
  vertical: 'down' | 'up' | null;
  /**
   * The direction the nearest scrollable container
   * most recently scrolled horizontally,
   * where 'direction' is either 'left' or 'right'.
   */
  horizontal: 'left' | 'right' | null;
}
```

## Examples

### Basic

<Playground>
  {() => {
    const ScrollDirectionUser = () => {
      const [{vertical}, ref] = useScrollDirection();
      return (
        <div
          ref={ref}
          style={{
            display: 'flex',
            justifyContent: 'center',
            alignItems: 'center',
            width: '100%',
            height: 250,
            fontSize: '2em',
            color: `${vertical == ScrollDirection.DOWN ? 'white' : 'yellow'}`,
            background: `${vertical == ScrollDirection.DOWN ? 'green' : 'red'}`,
          }}
        >
          {vertical == ScrollDirection.DOWN ? 'down' : 'up'}
        </div>
      );
    };
    return <ScrollDirectionUser />;
  }}
</Playground>

### [Scroll Up Bar] using [react-spring]

<Playground>
  {() => {
    const ScrollUpBar = () => {
      const ref = React.useRef();
      const {vertical} = useScrollDirection(ref);
      const [{height}, sizeRef] = useSize(ref);
      const transform = useSpring({
        config: config.stiff,
        transform: `translateY(${
          vertical === ScrollDirection.UP ? 0 : -height
        }px)`,
      });
      return (
        <div
          style={{
            display: 'flex',
            justifyContent: 'center',
            alignItems: 'center',
            position: 'relative',
            width: '100%',
            height: 250,
            fontSize: '2em',
            color: 'lightgray',
            overflow: 'hidden',
          }}
        >
          <animated.div
            ref={sizeRef}
            style={{
              position: 'absolute',
              top: 0,
              right: 0,
              left: 0,
              background: 'green',
              padding: '0 20px',
              color: 'white',
              ...transform,
            }}
          >
            Scroll down to hide me!
          </animated.div>
          <span>Scroll up to show the bar!</span>
        </div>
      );
    };
    return <ScrollUpBar />;
  }}
</Playground>

## Usage with Shared Ref / Ref Forwarding

Sometimes a component needs to [forward a ref] to its children,
or [use a ref][useref] with other hooks.
To support these cases, `useScrollDirection`
accepts an optional `providedRef` argument:

```js
const SomeRefForwardingComponent = React.forwardRef((props, forwardedRef) => {
  // We pass `forwardedRef` (which _must_ be a ref object)
  // to `useScrollDirection`. Note that a `ref`
  // will _not_ be returned with the `ScrollDirection` value.
  const scrollDirection = useScrollDirection(forwardedRef);
  return (
    <div ref={forwardedRef}>{JSON.stringify(scrollDirection, null, 2)}</div>
  );
});
```

or, with `useRef`:

```js
const SomeRefUsingComponent = () => {
  const ref = React.useRef(null);
  // We pass `ref` to `useScrollDirection`.
  // Note that a `ref` will _not_ be returned
  // with the `ScrollDirection` value.
  const scrollDirection = useScrollDirection(ref);
  return <div ref={ref}>{JSON.stringify(scrollDirection, null, 2)}</div>;
};
```

[hook]: https://reactjs.org/docs/hooks-overview.html
[ref]: https://reactjs.org/docs/refs-and-the-dom.html
[useref]: https://reactjs.org/docs/hooks-reference.html#useref
[callback ref]: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs
[ref object]: https://reactjs.org/docs/refs-and-the-dom.html#accessing-refs
[forward a ref]: https://reactjs.org/docs/forwarding-refs.html
[scroll up bar]: http://usabilitypost.com/2014/05/24/the-scroll-up-bar/
[react-spring]: https://www.react-spring.io/
[usage with shared ref / ref forwarding]: #usage-with-shared-ref--ref-forwarding
